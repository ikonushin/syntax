# ‚úÖ Checklist: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –±–∞–ª–∞–Ω—Å–æ–º —Å—á—ë—Ç–æ–≤

## üéØ –¶–µ–ª—å
–ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ —Å—á—ë—Ç–æ–≤ (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è 0 ‚ÇΩ –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π)

## üìã –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### Backend (‚úÖ –í–´–ü–û–õ–ù–ï–ù–û)
- [x] –î–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π endpoint `/v1/accounts/{account_id}/balances` –≤ `backend/routes/accounts.py`
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ –æ—Ç –±–∞–Ω–∫–æ–≤—Å–∫–æ–≥–æ API
- [x] –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö —Ç—Ä—ë—Ö –±–∞–Ω–∫–æ–≤ (ABank, SBank, VBank)
- [x] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ `client_id` (–∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –±–∞–∑–æ–≤–æ–≥–æ client_id –¥–ª—è —Ç–æ–∫–µ–Ω–∞)
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ –æ—Ç–≤–µ—Ç–∞
- [x] –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- [x] –û–±—Ä–∞–±–æ—Ç–∞–Ω—ã –≤—Å–µ —Ç–∏–ø—ã –æ—à–∏–±–æ–∫ (401, 403, 404, 503, 500)
- [x] –ü—Ä–æ–≤–µ—Ä–µ–Ω —Å–∏–Ω—Ç–∞–∫—Å–∏—Å Python –∫–æ–¥–∞
- [x] –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω backend –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
- [x] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ, —á—Ç–æ backend –∑–¥–æ—Ä–æ–≤

### Frontend (‚úÖ –í–´–ü–û–õ–ù–ï–ù–û)
- [x] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ –∏–∑ –æ—Ç–≤–µ—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞
- [x] –£–ª—É—á—à–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `formatAmount()` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –æ–±—ä–µ–∫—Ç–∞–º–∏ balance
- [x] –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –±–∞–ª–∞–Ω—Å–∞
- [x] –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö –∏–º—ë–Ω –ø–æ–ª–µ–π (amount, balanceAmount)

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (‚úÖ –í–´–ü–û–õ–ù–ï–ù–û)
- [x] –°–æ–∑–¥–∞–Ω–∞ –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –ø—Ä–æ–≤–µ—Ä–∫–µ (`BALANCE_FIX_INSTRUCTIONS.md`)
- [x] –°–æ–∑–¥–∞–Ω–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Å–≤–æ–¥–∫–∞ –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π (`docs/BALANCE_ENDPOINT_FIX_SUMMARY.md`)
- [x] –°–æ–∑–¥–∞–Ω–∞ –æ—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (`docs/BALANCE_ENDPOINT_DEBUG.md`)
- [x] –°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç (`test_balance.sh`)

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ (‚úÖ –ü–†–û–ô–î–ï–ù–´)
- [x] Python —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –≤–∞–ª–∏–¥–Ω—ã–π
- [x] Backend –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] API /health endpoint –¥–æ—Å—Ç—É–ø–µ–Ω

### –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Ä—É—á–Ω—É—é
1. **–ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ Tax Payments:**
   - [ ] –ë–∞–ª–∞–Ω—Å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è (–Ω–µ 0 ‚ÇΩ)
   - [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏ DevTools

2. **–í DevTools Console:**
   - [ ] –ï—Å—Ç—å –ª–æ–≥–∏ –≤–∏–¥–∞ "‚úÖ TaxPayments: Balance loaded: XXXX.XX RUB"
   - [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤–∏–¥–∞ "‚ùå Failed to load balance"

3. **–í Backend –ª–æ–≥–∞—Ö:**
   ```bash
   docker-compose logs backend | grep BALANCES
   ```
   - [ ] –í–∏–¥–Ω—ã —Å—Ç—Ä–æ–∫–∏ "üîç BALANCES: Using base_client_id=team286"
   - [ ] –í–∏–¥–Ω—ã —Å—Ç—Ä–æ–∫–∏ "‚úÖ BALANCES: Got X balance(s)"

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
```
GET /v1/accounts/{id}/balances ‚Üí 404 Not Found (endpoint –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
–ë–∞–ª–∞–Ω—Å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ: 0,00 ‚ÇΩ
Backend –ª–æ–≥–∏: -
Frontend –ª–æ–≥–∏: Failed to load balance
```

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è  
```
GET /v1/accounts/{id}/balances ‚Üí 200 OK (–Ω–æ–≤—ã–π endpoint —Ä–∞–±–æ—Ç–∞–µ—Ç)
–ë–∞–ª–∞–Ω—Å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ: 4 447,00 ‚ÇΩ (—Ä–µ–∞–ª—å–Ω–∞—è —Å—É–º–º–∞)
Backend –ª–æ–≥–∏: üîç BALANCES... ‚úÖ Balance loaded...
Frontend –ª–æ–≥–∏: ‚úÖ TaxPayments: Balance loaded: 4447.00 RUB
```

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
1. **Backend endpoint** - 164 —Å—Ç—Ä–æ–∫ –Ω–æ–≤–æ–≥–æ –∫–æ–¥–∞ –≤ `accounts.py`
2. **Client ID –ª–æ–≥–∏–∫–∞** - 8 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ team286 vs team286-9
3. **Frontend –ø–∞—Ä—Å–∏–Ω–≥** - 15 —Å—Ç—Ä–æ–∫ —É–ª—É—á—à–µ–Ω–Ω–æ–π –ª–æ–≥–∏–∫–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞
4. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ –Ω–∞ –æ–±–æ–∏—Ö –∫–æ–Ω—Ü–∞—Ö (frontend + backend)

### –ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
```python
# –ë–´–õ–û (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
token = get_bank_token(client_id="team286-9")  # ‚ùå 401 Unauthorized

# –°–¢–ê–õ–û (–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
base_id = "team286"  # –ò–∑–≤–ª–µ–∫–ª–∏ –±–∞–∑–æ–≤—ã–π ID
token = get_bank_token(client_id=base_id)  # ‚úÖ 200 OK
```

## üìù –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ
```
1. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:5173/tax-payments
2. F12 ‚Üí Console
3. –ò—â–∏—Ç–µ –ª–æ–≥–∏ —Å "Balance loaded"
4. –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –±–∞–ª–∞–Ω—Å –≤–º–µ—Å—Ç–æ 0 ‚ÇΩ
```

### –®–∞–≥ 2: –ï—Å–ª–∏ –±–∞–ª–∞–Ω—Å –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É 0
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å backend –ª–æ–≥–∏
docker-compose logs backend | grep -i balance

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å endpoint –Ω–∞–ø—Ä—è–º—É—é
curl http://localhost:8000/v1/accounts/acc-3959/balances \
  -H "Authorization: Bearer YOUR_JWT" \
  -H "consent_id: CONSENT_ID" \
  -H "X-Bank-Name: abank" \
  -H "client_id: team286-9"
```

### –®–∞–≥ 3: –ï—Å–ª–∏ –≤—Å—ë –µ—â—ë –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ .env –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π `CLIENT_SECRET`
2. –ü–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∏—Ç–µ –±–∞–Ω–∫ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ Banks
3. –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞ (Ctrl+Shift+Delete)
4. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É

## ‚ú® –°—Ç–∞—Ç—É—Å

```
STATUS: ‚úÖ READY FOR TESTING

–ò–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã:
‚úÖ Backend endpoint –¥–æ–±–∞–≤–ª–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
‚úÖ Frontend –ª–æ–≥–∏–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞
‚úÖ –°–∏–Ω—Ç–∞–∫—Å–∏—Å –≤–∞–ª–∏–¥–Ω—ã–π
‚úÖ –°–µ—Ä–≤–∏—Å –∑–¥–æ—Ä–æ–≤

–û–∂–∏–¥–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º:
‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ Tax Payments
‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞ (–Ω–µ 0 ‚ÇΩ)
```

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã:
1. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–ª–∞—Ç–µ–∂–∏ —Å —Ä–µ–∞–ª—å–Ω—ã–º –±–∞–ª–∞–Ω—Å–æ–º
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥—Ä—É–≥–∏–µ –±–∞–Ω–∫–∏ (SBank, VBank)
3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–∞—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
4. –û—Ç–ª–∞–¥–∏—Ç—å –ª—é–±—ã–µ edge cases

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-11-20
**–í–µ—Ä—Å–∏—è:** 1.0
**–°—Ç–∞—Ç—É—Å:** Ready for User Testing ‚úÖ
